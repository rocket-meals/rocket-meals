__d((function(g,r,i,a,m,e,d){"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Example=e.CardReader=e.MensaCardReaderHelper=void 0;const l=t(r(d[0]));e.MensaCardReaderHelper=l.default;const u=t(r(d[1]));e.CardReader=u.default;const n=t(r(d[2]));e.Example=n.default}),3614,[3636,3638,3639]);
__d((function(g,r,_i,a,m,_e,d){"use strict";var e=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,s){function c(e){try{u(o.next(e))}catch(e){s(e)}}function l(e){try{u(o.throw(e))}catch(e){s(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,l)}u((o=o.apply(e,n||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0});const t=n(r(d[0]));class o{static readMensaCardInformations(n,t){return e(this,void 0,void 0,(function*(){let e;try{e=yield o.private_getMensaCardInformations(n,t)}catch(e){console.warn(e)}return yield o._cleanUp(n),e}))}static private_getMensaCardInformations(n,i){return e(this,void 0,void 0,(function*(){console.log('MiFare Technology: ');const e=yield o.private_requestTechnology(n,i);if(console.log(JSON.stringify(e,null,2)),!e)return;console.log('Tag: ');const s=yield n.NfcManager.getTag();console.log(JSON.stringify(s,null,2)),console.log('Choose Application: ');const c=yield o.private_sendCommandToMensaCard(n,t.default.chooseApplication);if(console.log(JSON.stringify(c,null,2)),o.private_isValidResponse(c)){console.log('Read Current Balance: ');const e=yield o.getCurrentBalance(n);if(e){const t={currentBalance:e.currentBalance,currentBalanceRaw:e.currentBalanceRaw,lastTransaction:void 0,lastTransactionRaw:void 0,chooseAppRaw:c,tag:s,readTime:new Date};console.log('Read Last Transaction: ');const i=yield o.getLastTransaction(n);return i?(t.lastTransaction=i.lastTransaction,t.lastTransactionRaw=i.lastTransactionRaw,t):t}}console.warn('get Mensa Card Informations Failed')}))}static getCurrentBalance(n){return e(this,void 0,void 0,(function*(){const e=yield o.private_sendCommandToMensaCard(n,t.default.readCurrentBalance);if(console.log(JSON.stringify(e,null,2)),o.private_isValidResponse(e)){return{currentBalance:o.getValueFromBytes(e.slice(0,4).reverse()).toString(),currentBalanceRaw:e}}}))}static getLastTransaction(n){return e(this,void 0,void 0,(function*(){const e=yield o.private_sendCommandToMensaCard(n,t.default.readLastTransaction);if(console.log(JSON.stringify(e,null,2)),o.private_isValidResponse(e)){console.log('Get Value from Bytes: ');return{lastTransaction:o.getValueFromBytes(e.slice(12,14).reverse()).toString(),lastTransactionRaw:e}}}))}static private_getTechnology(e){return'ios'===e.Platform.OS?e.NfcTech.MifareIOS:e.NfcTech.IsoDep}static private_requestTechnology(n,t){return e(this,void 0,void 0,(function*(){try{return yield n.NfcManager.requestTechnology(o.private_getTechnology(n),{alertMessage:t})}catch(e){console.warn('request NFC Technology failed'),console.warn(e)}}))}static private_sendCommandToMensaCard(n,t){return e(this,void 0,void 0,(function*(){try{return'ios'===n.Platform.OS?yield n.NfcManager.sendMifareCommandIOS(t):yield n.NfcManager.transceive(t)}catch(e){return void console.warn(e)}}))}static private_isValidResponse(e){return!!e&&(e.length>=2&&145===e[e.length-2])}static getValueFromBytes(e){let n=0;for(let t=0;t<e.length;++t)n+=e[t],t<e.length-1&&(n<<=8);return n/1e3}static _cleanUp(n){return e(this,void 0,void 0,(function*(){console.log('Clean Up');try{yield n.NfcManager.cancelTechnologyRequest(),yield n.NfcManager.unregisterTagEvent(),console.log('Success to cancelTechnologyRequest')}catch(e){console.warn('Clean Up failed')}}))}}_e.default=o}),3636,[3637]);
__d((function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class t{}e.default=t,t.chooseApplication=[144,90,0,0,3,95,132,21,0],t.readCurrentBalance=[144,108,0,0,1,1,0],t.readLastTransaction=[144,245,0,0,1,1,0]}),3637,[]);
__d((function(g,r,i,a,m,_e,d){"use strict";var t=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(s,u){function c(t){try{l(o.next(t))}catch(t){u(t)}}function f(t){try{l(o.throw(t))}catch(t){u(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,f)}l((o=o.apply(t,e||[])).next())}))},e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_e,"__esModule",{value:!0});const n=e(r(d[0]));_e.default=class{constructor(t,e,n){this.NfcManager=t,this.NfcTech=e,this.Platform=n}isSupported(){return t(this,void 0,void 0,(function*(){return('ios'===this.Platform.OS||'android'===this.Platform.OS)&&(yield this.NfcManager.isSupported())}))}isEnabled(){return t(this,void 0,void 0,(function*(){return('ios'===this.Platform.OS||'android'===this.Platform.OS)&&(yield this.NfcManager.isEnabled())}))}isApple(){return'ios'===this.Platform.OS}readCard(e){return t(this,void 0,void 0,(function*(){let t;void 0===e&&(e='Hold your phone near the card');try{yield this.NfcManager.start();t=yield n.default.readMensaCardInformations(this,e)}catch(t){console.warn(t)}return yield n.default._cleanUp(this),t}))}}}),3638,[3636]);
__d((function(g,r,i,_a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{static multiply(t,u){return t*u}}}),3639,[]);