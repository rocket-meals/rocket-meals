__d((function(g,r,i,a,m,e,d){"use strict";var t=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Example=e.CardReader=e.MensaCardReaderHelper=void 0;var l=t(r(d[0]));e.MensaCardReaderHelper=l.default;var u=t(r(d[1]));e.CardReader=u.default;var f=t(r(d[2]));e.Example=f.default}),3291,[3313,3315,3316]);
__d((function(g,r,_i,a,m,_e,d){"use strict";var e=r(d[0]),n=r(d[1]),t=this&&this.__awaiter||function(e,n,t,o){return new(t||(t=Promise))((function(i,l){function c(e){try{u(o.next(e))}catch(e){l(e)}}function s(e){try{u(o.throw(e))}catch(e){l(e)}}function u(e){var n;e.done?i(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,s)}u((o=o.apply(e,n||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0});var i=o(r(d[2])),l=(function(){function o(){e(this,o)}return n(o,null,[{key:"readMensaCardInformations",value:function(e,n){return t(this,void 0,void 0,(function*(){var t;try{t=yield o.private_getMensaCardInformations(e,n)}catch(e){console.warn(e)}return yield o._cleanUp(e),t}))}},{key:"private_getMensaCardInformations",value:function(e,n){return t(this,void 0,void 0,(function*(){console.log('MiFare Technology: ');var t=yield o.private_requestTechnology(e,n);if(console.log(JSON.stringify(t,null,2)),t){console.log('Tag: ');var l=yield e.NfcManager.getTag();console.log(JSON.stringify(l,null,2)),console.log('Choose Application: ');var c=yield o.private_sendCommandToMensaCard(e,i.default.chooseApplication);if(console.log(JSON.stringify(c,null,2)),o.private_isValidResponse(c)){console.log('Read Current Balance: ');var s=yield o.getCurrentBalance(e);if(s){var u={currentBalance:s.currentBalance,currentBalanceRaw:s.currentBalanceRaw,lastTransaction:void 0,lastTransactionRaw:void 0,chooseAppRaw:c,tag:l,readTime:new Date};console.log('Read Last Transaction: ');var f=yield o.getLastTransaction(e);return f?(u.lastTransaction=f.lastTransaction,u.lastTransactionRaw=f.lastTransactionRaw,u):u}}console.warn('get Mensa Card Informations Failed')}}))}},{key:"getCurrentBalance",value:function(e){return t(this,void 0,void 0,(function*(){var n=yield o.private_sendCommandToMensaCard(e,i.default.readCurrentBalance);return console.log(JSON.stringify(n,null,2)),o.private_isValidResponse(n)?{currentBalance:o.getValueFromBytes(n.slice(0,4).reverse()).toString(),currentBalanceRaw:n}:void 0}))}},{key:"getLastTransaction",value:function(e){return t(this,void 0,void 0,(function*(){var n=yield o.private_sendCommandToMensaCard(e,i.default.readLastTransaction);return console.log(JSON.stringify(n,null,2)),o.private_isValidResponse(n)?(console.log('Get Value from Bytes: '),{lastTransaction:o.getValueFromBytes(n.slice(12,14).reverse()).toString(),lastTransactionRaw:n}):void 0}))}},{key:"private_getTechnology",value:function(e){return'ios'===e.Platform.OS?e.NfcTech.MifareIOS:e.NfcTech.IsoDep}},{key:"private_requestTechnology",value:function(e,n){return t(this,void 0,void 0,(function*(){try{return yield e.NfcManager.requestTechnology(o.private_getTechnology(e),{alertMessage:n})}catch(e){console.warn('request NFC Technology failed'),console.warn(e)}}))}},{key:"private_sendCommandToMensaCard",value:function(e,n){return t(this,void 0,void 0,(function*(){try{return'ios'===e.Platform.OS?yield e.NfcManager.sendMifareCommandIOS(n):yield e.NfcManager.transceive(n)}catch(e){return void console.warn(e)}}))}},{key:"private_isValidResponse",value:function(e){return!!e&&(e.length>=2&&145===e[e.length-2])}},{key:"getValueFromBytes",value:function(e){for(var n=0,t=0;t<e.length;++t)n+=e[t],t<e.length-1&&(n<<=8);return n/1e3}},{key:"_cleanUp",value:function(e){return t(this,void 0,void 0,(function*(){console.log('Clean Up');try{yield e.NfcManager.cancelTechnologyRequest(),yield e.NfcManager.unregisterTagEvent(),console.log('Success to cancelTechnologyRequest')}catch(e){console.warn('Clean Up failed')}}))}}]),o})();_e.default=l}),3313,[14,10,3314]);
__d((function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]),n=r(d[1]);Object.defineProperty(e,"__esModule",{value:!0});var c=t((function t(){n(this,t)}));e.default=c,c.chooseApplication=[144,90,0,0,3,95,132,21,0],c.readCurrentBalance=[144,108,0,0,1,1,0],c.readLastTransaction=[144,245,0,0,1,1,0]}),3314,[10,14]);
__d((function(g,r,i,a,m,_e,d){"use strict";var t=r(d[0]),n=r(d[1]),e=this&&this.__awaiter||function(t,n,e,o){return new(e||(e=Promise))((function(u,s){function f(t){try{l(o.next(t))}catch(t){s(t)}}function c(t){try{l(o.throw(t))}catch(t){s(t)}}function l(t){var n;t.done?u(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(f,c)}l((o=o.apply(t,n||[])).next())}))},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_e,"__esModule",{value:!0});var u=o(r(d[2])),s=(function(){function o(n,e,u){t(this,o),this.NfcManager=n,this.NfcTech=e,this.Platform=u}return n(o,[{key:"isSupported",value:function(){return e(this,void 0,void 0,(function*(){return('ios'===this.Platform.OS||'android'===this.Platform.OS)&&(yield this.NfcManager.isSupported())}))}},{key:"isEnabled",value:function(){return e(this,void 0,void 0,(function*(){return('ios'===this.Platform.OS||'android'===this.Platform.OS)&&(yield this.NfcManager.isEnabled())}))}},{key:"isApple",value:function(){return'ios'===this.Platform.OS}},{key:"readCard",value:function(t){return e(this,void 0,void 0,(function*(){var n;void 0===t&&(t='Hold your phone near the card');try{yield this.NfcManager.start();n=yield u.default.readMensaCardInformations(this,t)}catch(t){console.warn(t)}return yield u.default._cleanUp(this),n}))}}]),o})();_e.default=s}),3315,[14,10,3313]);
__d((function(g,r,i,_a,m,e,d){"use strict";var t=r(d[0]),u=r(d[1]);Object.defineProperty(e,"__esModule",{value:!0});var n=(function(){function n(){t(this,n)}return u(n,null,[{key:"multiply",value:function(t,u){return t*u}}]),n})();e.default=n}),3316,[14,10]);